!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).funcyjs={})}(this,function(e){"use strict";const t=new(WeakMap||Map);let n;const o=(e,o)=>(...r)=>{if(void 0===n)throw new Error("Hook was called outside of run()!");const s=t.get(n);return s.hookStateIndex++,void 0===s.hookStates[s.hookStateIndex]&&(s.hookStates[s.hookStateIndex]={value:void 0},s.hookStates[s.hookStateIndex].hookApi=((e,t)=>{const o=t.hookStates[t.hookStateIndex];return{onCleanUp(e){o.cleanUp=e},beforeNextRun(e){o.beforeNextRun=e},afterCurrentRun(e){o.afterCurrentRun=e},getContext:()=>n,getValue:e=>(void 0===o.value&&(o.value=e),o.value),setValue(n,r=!1){let s=o.value;o.value=n,!r&&t.onValueChange&&t.onValueChange(e,n,s)}}})(e,s)),o(s.hookStates[s.hookStateIndex].hookApi,...r)};function r(e,t){for(const n of t)n[e]&&(n[e](),n[e]=void 0)}const s=(e,n)=>{if(!(e instanceof Object))throw new Error("Context must be an object!");t.set(e,{hookStates:[],hookStateIndex:-1,onValueChange:n})},i=e=>{const n=t.get(e);r("cleanUp",n.hookStates),n.hookStates.length=0,n.delete(e)},a=o("useReducer",({getValue:e,setValue:t},n,o)=>{const r=e(o);return[r,e=>{t(n(r,e))}]}),l=o("useEffect",({getValue:e,setValue:t,onCleanUp:n,afterCurrentRun:o},r,s)=>{let{values:i,cleanUp:a}=e({}),l=!1;if(i!==s&&i&&i.length>0){l=!0;let e=i.length;for(;e--;)if(s[e]!==i[e]){l=!1;break}i=s}l||(a&&a(),o(()=>{a=r(),t({values:s,cleanUp:a}),n(a?()=>{a()}:void 0)}))}),u=new Map;let c=!1;const p=[],d=e=>((e,o,...s)=>{if(void 0!==n)throw new Error("Tried to start a run before the end of the previous run!");if(!t.has(e))throw new Error("Tried to start a run without a registered context!");n=e;const i=t.get(n);i.hookStateIndex=-1,r("beforeNextRun",i.hookStates);const a=o(...s),l=e=>(r("afterCurrentRun",i.hookStates),n=void 0,e);return a instanceof Promise?a.then(l):l(a)})(e,e.render),f=async()=>{const e=p.length;c=!0,Promise.resolve().then(async()=>{let t=e;for(;t--;)await d(p[e-t-1]);p.splice(0,e),c=!1,p.length>0&&f()})},h=(e,t)=>{(-1===p.indexOf(e)&&!0===e._isConnected||t)&&p.push(e),c||f()},v=e=>{const t=u.get(e);return u.delete(e),t};let _=1e5;const m=(e,t)=>{(e instanceof NodeList?t.contains(e[0]):t.contains(e))||(t.innerHTML="",e instanceof NodeList?e.forEach(e=>t.appendChild(e)):t.appendChild(e))},C=new Map;const g=o("useAttribute",(e,{getContext:t})=>{const n=t();return[n.getAttribute(e),t=>{n.skipQueue=!0,n.setAttribute(e,t)}]}),b=o("useCSS",(e,...t)=>{const{getContext:n}=t.pop();let o;o=(o=e instanceof Array?e.map((e,n)=>t[n]?e+t[n]:e).join(""):e).replace(/ +(?= )/g,"").replace(/\n/g,"");const r=n()._shadowRoot,s=document.createElement("style");s.innerHTML=o,l(()=>(r.appendChild(s),()=>{r.removeChild(s)}))}),y=o("useExposeMethod",(e,t,{getContext:n})=>{n()[e]=((...e)=>t(...e))}),x=o("useRenderer",(e,{getContext:t,getState:n})=>{const o=n(e);t()._renderer=o}),k=o("useHostElement",({getContext:e})=>e()),w=o("useShadowRoot",({getContext:e})=>e()._shadowRoot),S=o("useConnectedState",({getContext:e})=>{return e()._isConnected});function N(){}var E={},R=[],A=[];function M(e,t){for(var n in t)e[n]=t[n];return e}var L="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,P=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,T=[];function U(e){!e._dirty&&(e._dirty=!0)&&1==T.push(e)&&L(V)}function V(){var e,t=T;for(T=[];e=t.pop();)e._dirty&&Z(e)}function H(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function j(e){var t=M({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===t[o]&&(t[o]=n[o]);return t}function B(e){var t=e.parentNode;t&&t.removeChild(e)}function I(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),o&&o(e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var s in n)s in o||(e.style[s]="");for(var s in o)e.style[s]="number"==typeof o[s]&&!1===P.test(s)?o[s]+"px":o[s]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var i=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,O,i):e.removeEventListener(t,O,i),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==o?"":o),null!=o&&!1!==o||e.removeAttribute(t);else{var a=r&&t!==(t=t.replace(/^xlink:?/,""));null==o||!1===o?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function O(e){return this._listeners[e.type](e)}var W=[],$=0,D=!1,Q=!1;function z(){for(var e;e=W.pop();)e.componentDidMount&&e.componentDidMount()}function F(e,t,n,o,r,s){$++||(D=null!=r&&void 0!==r.ownerSVGElement,Q=null!=e&&!("__preactattr_"in e));var i=function e(t,n,o,r,s){var i=t,a=D;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||s)?t.nodeValue!=n&&(t.nodeValue=n):(i=document.createTextNode(n),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),G(t,!0))),i.__preactattr_=!0,i;var l,u,c=n.nodeName;if("function"==typeof c)return function(e,t,n,o){for(var r=e&&e._component,s=r,i=e,a=r&&e._componentConstructor===t.nodeName,l=a,u=j(t);r&&!l&&(r=r._parentComponent);)l=r.constructor===t.nodeName;return r&&l&&(!o||r._component)?(Y(r,u,3,n,o),e=r.base):(s&&!a&&(ee(s),e=i=null),r=K(t.nodeName,u,n),e&&!r.nextBase&&(r.nextBase=e,i=null),Y(r,u,1,n,o),e=r.base,i&&e!==i&&(i._component=null,G(i,!1))),e}(t,n,o,r);if(D="svg"===c||"foreignObject"!==c&&D,c=String(c),(!t||!H(t,c))&&(l=c,(u=D?document.createElementNS("http://www.w3.org/2000/svg",l):document.createElement(l)).normalizedNodeName=l,i=u,t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),G(t,!0)}var p=i.firstChild,d=i.__preactattr_,f=n.children;if(null==d){d=i.__preactattr_={};for(var h=i.attributes,v=h.length;v--;)d[h[v].name]=h[v].value}return!Q&&f&&1===f.length&&"string"==typeof f[0]&&null!=p&&void 0!==p.splitText&&null==p.nextSibling?p.nodeValue!=f[0]&&(p.nodeValue=f[0]):(f&&f.length||null!=p)&&function(t,n,o,r,s){var i,a,l,u,c,p,d,f,h=t.childNodes,v=[],_={},m=0,C=0,g=h.length,b=0,y=n?n.length:0;if(0!==g)for(var x=0;x<g;x++){var k=h[x],w=k.__preactattr_,S=y&&w?k._component?k._component.__key:w.key:null;null!=S?(m++,_[S]=k):(w||(void 0!==k.splitText?!s||k.nodeValue.trim():s))&&(v[b++]=k)}if(0!==y)for(var x=0;x<y;x++){c=null;var S=(u=n[x]).key;if(null!=S)m&&void 0!==_[S]&&(c=_[S],_[S]=void 0,m--);else if(!c&&C<b)for(i=C;i<b;i++)if(void 0!==v[i]&&(p=a=v[i],f=s,"string"==typeof(d=u)||"number"==typeof d?void 0!==p.splitText:"string"==typeof d.nodeName?!p._componentConstructor&&H(p,d.nodeName):f||p._componentConstructor===d.nodeName)){c=a,v[i]=void 0,i===b-1&&b--,i===C&&C++;break}c=e(c,u,o,r),l=h[x],c&&c!==t&&c!==l&&(null==l?t.appendChild(c):c===l.nextSibling?B(l):t.insertBefore(c,l))}if(m)for(var x in _)void 0!==_[x]&&G(_[x],!1);for(;C<=b;)void 0!==(c=v[b--])&&G(c,!1)}(i,f,o,r,Q||null!=d.dangerouslySetInnerHTML),function(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||I(e,o,n[o],n[o]=void 0,D);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||I(e,o,n[o],n[o]=t[o],D)}(i,n.attributes,d),D=a,i}(e,t,n,o,s);return r&&i.parentNode!==r&&r.appendChild(i),--$||(Q=!1,s||z()),i}function G(e,t){var n=e._component;n?ee(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||B(e),J(e))}function J(e){for(e=e.lastChild;e;){var t=e.previousSibling;G(e,!0),e=t}}var q={};function K(e,t,n){var o,r=q[e.name];if(e.prototype&&e.prototype.render?(o=new e(t,n),te.call(o,t,n)):((o=new te(t,n)).constructor=e,o.render=X),r)for(var s=r.length;s--;)if(r[s].constructor===e){o.nextBase=r[s].nextBase,r.splice(s,1);break}return o}function X(e,t,n){return this.constructor(e,n)}function Y(e,t,n,o,r){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||r?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===E.syncComponentUpdates&&e.base?U(e):Z(e,1,r)),e.__ref&&e.__ref(e))}function Z(e,t,n,o){if(!e._disable){var r,s,i,a=e.props,l=e.state,u=e.context,c=e.prevProps||a,p=e.prevState||l,d=e.prevContext||u,f=e.base,h=e.nextBase,v=f||h,_=e._component,m=!1;if(f&&(e.props=c,e.state=p,e.context=d,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(a,l,u)?m=!0:e.componentWillUpdate&&e.componentWillUpdate(a,l,u),e.props=a,e.state=l,e.context=u),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!m){r=e.render(a,l,u),e.getChildContext&&(u=M(M({},u),e.getChildContext()));var C,g,b=r&&r.nodeName;if("function"==typeof b){var y=j(r);(s=_)&&s.constructor===b&&y.key==s.__key?Y(s,y,1,u,!1):(C=s,e._component=s=K(b,y,u),s.nextBase=s.nextBase||h,s._parentComponent=e,Y(s,y,0,u,!1),Z(s,1,n,!0)),g=s.base}else i=v,(C=_)&&(i=e._component=null),(v||1===t)&&(i&&(i._component=null),g=F(i,r,u,n||!f,v&&v.parentNode,!0));if(v&&g!==v&&s!==_){var x=v.parentNode;x&&g!==x&&(x.replaceChild(g,v),C||(v._component=null,G(v,!1)))}if(C&&ee(C),e.base=g,g&&!o){for(var k=e,w=e;w=w._parentComponent;)(k=w).base=g;g._component=k,g._componentConstructor=k.constructor}}if(!f||n?W.unshift(e):m||e.componentDidUpdate&&e.componentDidUpdate(c,p,d),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);$||o||z()}}function ee(e){var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?ee(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,B(t),function(e){var t=e.constructor.name;(q[t]||(q[t]=[])).push(e)}(e),J(t)),e.__ref&&e.__ref(null)}function te(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}M(te.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=M({},n)),M(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),U(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),Z(this,2)},render:function(){}});var ne={},oe=JSON.stringify;var re=function(e){for(var t=".",n=0;n<e.length;n++)t+=e[n].length+","+e[n];return(ne[t]||(ne[t]=function(e){for(var t,n,o,r,s,i=0,a="return ",l="",u="",c=0,p="",d="",f="",h=0,v=function(){o?9===i?(c++&&(a+=","),a+="h("+(u||oe(l)),i=0):13===i||0===i&&"..."===l?(0===i?(f||(f=")",p=p?"Object.assign("+p:"Object.assign({}"),p+=d+","+u,d=""):r&&(p+=p?","+(d?"":"{"):"{",d="}",p+=oe(r)+":",p+=u||(s||l)&&oe(l)||"true",r=""),s=!1):0===i&&(i=13,r=l,l=u="",v(),i=0):(u||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))&&(c++&&(a+=","),a+=u||oe(l)),l=u=""},_=0;_<e.length;_++){_>0&&(o||v(),u="$["+_+"]",v());for(var m=0;m<e[_].length;m++){if(n=e[_].charCodeAt(m),o){if(39===n||34===n){if(h===n){h=0;continue}if(0===h){h=n;continue}}if(0===h)switch(n){case 62:v(),47!==i&&(a+=p?","+p+d+f:",null"),t&&(a+=")"),o=0,p="",i=1;continue;case 61:i=13,s=!0,r=l,l="";continue;case 47:t||(t=!0,9!==i||l.trim()||(l=u="",i=47));continue;case 9:case 10:case 13:case 32:v(),i=0;continue}}else if(60===n){v(),o=1,f=d=p="",t=s=!1,i=9;continue}l+=e[_].charAt(m)}}return v(),Function("h","$",a)}(e)))(this,arguments)}.bind(function(e,t){var n,o,r,s,i=arguments,a=A;for(s=arguments.length;s-- >2;)R.push(i[s]);for(t&&null!=t.children&&(R.length||R.push(t.children),delete t.children);R.length;)if((o=R.pop())&&void 0!==o.pop)for(s=o.length;s--;)R.push(o[s]);else"boolean"==typeof o&&(o=null),(r="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(r=!1)),r&&n?a[a.length-1]+=o:a===A?a=[o]:a.push(o),n=r;var l=new N;return l.nodeName=e,l.children=a,l.attributes=null==t?void 0:t,l.key=null==t?void 0:t.key,l});const se=o("usePreactHtm",()=>(x((e,t)=>{!function(e,t){!function(e,t,n){F(n,e,{},!1,t,!1)}(e,t,t.firstElementChild)}(e,t)}),re));e.defineComponent=((e,t,n={})=>{C.has(e)?console.warn(`Component ${e} was already defined.`):(C.set(e,t),function(e,t={}){customElements.define(e,class extends HTMLElement{constructor(){super(),this._props={},this._renderer=m,this._isConnected=!1,s(this,(e,t,n)=>{"useReducer"===e&&t!==n&&h(element)})}connectedCallback(){this._shadowRoot||(this._shadowRoot=this.attachShadow({mode:"open",...t.shadowOptions?t.shadowOptions:{}})),this._isConnected||(this._isConnected=!0,h(this))}disconnectedCallback(){this._isConnected&&(this._isConnected=!1,h(this))}destroy(){this.parentElement.removeChild(this),i(this)}async render(){const t=this.getAttribute("data-props");t&&(this._props=v(t),this.skipQueue=!0,this.removeAttribute("data-props"));const n=await Promise.resolve().then(()=>C.get(e)(this._props));await this._renderer(n,this._shadowRoot),this.init=!1}attributeChangedCallback(e,t,n){this.init||(this.skipQueue||t===n||h(this),this.skipQueue=!1)}static get observedAttributes(){let e=["data-props"];return t.observedAttributes&&(e=e.concat(t.observedAttributes)),e}})}(e,n))}),e.prps=(e=>{return{"data-props":(e=>{let t=_.toString(16);return _++,t.length%2&&(t="0"+t),u.set(t,e),t})(e)}}),e.createHook=o,e.useReducer=a,e.useState=(e=>{const[t,n]=a((e,t)=>t.value,e);return[t,e=>n({type:"set_state",value:e})]}),e.useEffect=l,e.useAttribute=g,e.useCSS=b,e.useExposeMethod=y,e.useRenderer=x,e.useHostElement=k,e.useShadowRoot=w,e.useConnectedState=S,e.usePreactHtm=se,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=full.min.js.map
