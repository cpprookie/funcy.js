<!DOCTYPE html>
<html>
  <head>
    <title>Parcel Sandbox</title>
    <meta charset="UTF-8" />
  </head>

  <body>
    <test-component></test-component>

    <script type="module">
      import {
        defineComponent,
        useReducer,
        useState,
        usePreactHtm,
        useEffect,
        usePassProps
      } from "../src/index.mjs";

      //test
      defineComponent("test-component", () => {
        const [state1, dispatch] = useReducer((state, action) => {
          if (action.type === "increment") {
            return state + 1;
          }
        }, 4);
        const [state2, setState] = useState(1);
        const [html] = usePreactHtm();
        useEffect(() => {
          console.log("hi")
          return () => console.log("ho")
        },[state1])
        const props = usePassProps({sum:state1+state2})
        return html`
          <div class="app">
            <test-component2 ...${props}></test-component2>
            <button onClick=${() => dispatch({ type: "increment" })}>
              ${state1}
            </button>
            <button onClick=${() => setState(state2 + 1)}>${state2}</button>
          </div>
        `;
      });
      defineComponent("test-component2", (props) => {
        const {sum} = props;
        const [html] = usePreactHtm();
        return html`
          <div>${sum}</div>
        `;
      });
    </script>
  </body>
</html>
